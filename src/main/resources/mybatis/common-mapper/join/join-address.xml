<?xml version="1.0" encoding="UTF-8"?>
<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  ~
  ~    Copyright (c) 2022 - 2023.
  ~    Haixing Hu, Qubit Co. Ltd.
  ~
  ~    All rights reserved.
  ~
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ltd.qubit.commons.dao.mapper">

  <!--
    关联 street, district, city, province, country 表获取 Address 对象的字段

    == 参数 ==
    alias:            主表的别名，既拥有 Address.street.id 字段的表的别名
    columnPrefix:     主表中表示 Address.street.id 的字段名的前缀
    streetAlias:      关联的street表的别名
    districtAlias:    关联的district表的别名
    cityAlias:        关联的city表的别名
    provinceAlias:    关联的province表的别名
    countryAlias:     关联的country表的别名
  -->
  <sql id="joinAddress">
    LEFT JOIN `street`          AS ${streetAlias}
      ON ${streetAlias}.`id`    =  ${alias}.`${columnPrefix}street_id`
    LEFT JOIN `district`        AS ${districtAlias}
      ON ${districtAlias}.`id`  =  ${streetAlias}.`district_id`
    LEFT JOIN `city`            AS ${cityAlias}
      ON ${cityAlias}.`id`      =  ${districtAlias}.`city_id`
    LEFT JOIN `province`        AS ${provinceAlias}
      ON ${provinceAlias}.`id`  =  ${cityAlias}.`province_id`
    LEFT JOIN `country`         AS ${countryAlias}
      ON ${countryAlias}.`id`   =  ${provinceAlias}.`country_id`
  </sql>
</mapper>
